"use strict";(self.webpackChunkcedri_ugv_dashboard=self.webpackChunkcedri_ugv_dashboard||[]).push([[880],{83880:function(e,t,r){r.r(t),r.d(t,{default:function(){return x}});var n=r(82937),a=r(1413),o=r(15671),i=r(43144),l=r(60136),s=r(27277),c=r(47313),u=r(78315),m=r(95436),f=r(96543),d=r(89755),p=r(91372),h=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},g=(0,c.forwardRef)((function(e,t){var r=e.chartRef,n=e.style,a=void 0===n?{height:"inherit"}:n,o=e.className,i=e.loading,l=e.loadingTemplate,s=e.errorTemplate,g=h(e,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),y=(0,m.Z)(u.Heatmap,g),b=y.chart,v=y.container;return(0,c.useEffect)((function(){(0,f.J)(r,b.current)}),[b.current]),(0,c.useImperativeHandle)(t,(function(){return{getChart:function(){return b.current}}})),c.createElement(d.Z,{errorTemplate:s},i&&c.createElement(p.Z,{loadingTemplate:l,theme:e.theme}),c.createElement("div",{className:o,style:a,ref:v}))})),y=r(46417),b=function(e){(0,l.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).componentDidMount=function(){n.asyncFetch()},n.asyncFetch=function(){fetch("https://gw.alipayobjects.com/os/antvdemo/assets/data/heatmap.json").then((function(e){return e.json()})).then((function(e){return n.setState({data:e})})).catch((function(e){console.log("fetch data failed",e)}))},n.config={type:"density",xField:"g",yField:"l",colorField:"tmp",color:"#F51D27-#FA541C-#FF8C12-#FFC838-#FAFFA8-#80FF73-#12CCCC-#1890FF-#6E32C2",legend:{position:"bottom"},annotations:[{type:"image",start:["min","max"],end:["max","min"],src:"https://gw.alipayobjects.com/zos/rmsportal/NeUTMwKtPcPxIFNTWZOZ.png"}]},n.state={data:[],ticks:-1,quality:0},n}return(0,i.Z)(r,[{key:"render",value:function(){return(0,y.jsx)("div",{children:(0,y.jsx)(g,(0,a.Z)((0,a.Z)({},this.config),{},{data:this.state.data,sx:{width:300,height:300}}))})}}]),r}(c.Component),v=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},F=(0,c.forwardRef)((function(e,t){var r=e.chartRef,n=e.style,a=void 0===n?{height:"inherit"}:n,o=e.className,i=e.loading,l=e.loadingTemplate,s=e.errorTemplate,h=v(e,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),g=(0,m.Z)(u.Bullet,h),y=g.chart,b=g.container;return(0,c.useEffect)((function(){(0,f.J)(r,y.current)}),[y.current]),(0,c.useImperativeHandle)(t,(function(){return{getChart:function(){return y.current}}})),c.createElement(d.Z,{errorTemplate:s},i&&c.createElement(p.Z,{loadingTemplate:l,theme:e.theme}),c.createElement("div",{className:o,style:a,ref:b}))})),O=r(8515),j=JSON.stringify({dataSource:"CeDRI",database:"CeDRI_UGV_buffer",collection:"Battery_Data",pipeline:[{$project:{dateTime:1,percentage:1}},{$sort:{dateTime:-1}},{$limit:1}]}),k=[{title:"Percent",ranges:[20,80,100],measures:[65],target:80},{title:"Current",ranges:[1,4,8],measures:[3],target:100},{title:"Voltage",ranges:[16,24,26],measures:[20],target:85},{title:"Temperature",ranges:[0,50,100],measures:[60],target:100}],w=function(e){(0,l.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).componentDidMount=function(){n.refreshList(),n.timer()},n.componentWillUnmount=function(){clearInterval(n.timer)},n.timer=function(){setInterval((function(){n.canUpdate()}),1e3)},n.config={data:k,measureField:"measures",rangeField:"ranges",targetField:"target",xField:"title",color:{range:["#FFbcb8","#FFe0b0","#bfeec8"],measure:"#5B8FF9",target:"#39a3f4"},label:{measure:{position:"middle",style:{fill:"#fff"}}},xAxis:{line:null},yAxis:!1,legend:{custom:!1,position:"bottom",items:[{value:"\u5dee",name:"\u5dee",marker:{symbol:"square",style:{fill:"#FFbcb8",r:5}}},{value:"\u826f",name:"\u826f",marker:{symbol:"square",style:{fill:"#FFe0b0",r:5}}},{value:"\u4f18",name:"\u4f18",marker:{symbol:"square",style:{fill:"#bfeec8",r:5}}},{value:"\u5b9e\u9645\u503c",name:"\u5b9e\u9645\u503c",marker:{symbol:"square",style:{fill:"#5B8FF9",r:5}}},{value:"\u76ee\u6807\u503c",name:"\u76ee\u6807\u503c",marker:{symbol:"line",style:{stroke:"#39a3f4",r:5}}}]}},n.state={data:[],ticks:-1},n}return(0,i.Z)(r,[{key:"canUpdate",value:function(){JSON.parse(window.localStorage.getItem("fromLocal"))||this.state.ticks<=0?(this.setState({ticks:10}),this.refreshList()):JSON.parse(window.localStorage.getItem("fromLocal"))||this.setState({ticks:this.state.ticks-1})}},{key:"refreshList",value:function(){var e=this;fetch((0,O.H)(),(0,O.w)(j)).then((function(e){return e.json()})).then((function(t){e.setState({data:t[0].percentage})})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return(0,y.jsx)("div",{children:(0,y.jsx)(F,(0,a.Z)({},this.config))})}}]),r}(c.Component),x=function(){return(0,y.jsxs)(n.ZP,{container:!0,rowSpacing:1.75,columnSpacing:2,children:[(0,y.jsx)(b,{}),(0,y.jsx)(w,{})]})}}}]);